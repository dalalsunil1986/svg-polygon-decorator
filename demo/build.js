(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.svgCloud = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var _decorator = require('../src/decorator');

var _decorator2 = _interopRequireDefault(_decorator);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var form = document.querySelector('.controls');
var clouds = [{
  selector: '#cloud1',
  coords: [[10, 120], [180, 120], [230, 180]]
}, {
  selector: '#cloud2',
  coords: [[20, 300], [180, 300], [200, 330], [190, 360], [140, 420], [70, 380]]
}, {
  selector: '#cloud3',
  coords: [[460, 120], [290, 120], [240, 180]]
}, {
  selector: '#cloud4',
  coords: [[450, 300], [290, 300], [270, 330], [280, 360], [330, 420], [400, 380]]
}, {
  selector: '#cloud_l1',
  coords: [[10, 10], [230, 10]]
}, {
  selector: '#cloud_l2',
  coords: [[450, 10], [240, 10]]
}];

var render = function render() {
  var elem = void 0;
  var cloud = void 0;
  var radius = parseFloat(form.radius.value);
  var closed = form.closed.checked;
  var inward = form.inward.checked;

  for (var ind = 0, cnt = clouds.length; ind < cnt; ++ind) {
    elem = document.querySelector(clouds[ind].selector);
    cloud = (0, _decorator2.default)(clouds[ind].coords, radius, closed, inward);
    elem.setAttribute('d', cloud);
  }
};

form.addEventListener('change', render);
render();

},{"../src/decorator":2}],2:[function(require,module,exports){
'use strict';

/**
 * Generates svg cloud for polygon
 *
 * @param  {Polygon} polygon
 *
 * @return {SVG Path}
 */

var X = 0;
var Y = 1;
var FLOAT_PRECISE = 0.000001;

var lineLength = function lineLength(line) {
  var pointA = line[0];
  var pointB = line[1];

  return Math.sqrt(Math.pow(pointB[X] - pointA[X], 2) + Math.pow(pointB[Y] - pointA[Y], 2));
};

var getIntersection = function getIntersection(line, length) {
  var pointC = null;
  var pointA = line[0];
  var pointB = line[1];
  var delta = void 0;
  var xPoint = void 0;
  var yPoint = void 0;
  var fullLen = lineLength(line);

  if (Math.abs(fullLen - length) < FLOAT_PRECISE) {
    pointC = pointB;
  } else if (fullLen > length) {
    delta = length / (fullLen - length);
    xPoint = (pointA[X] + delta * pointB[X]) / (1 + delta);
    yPoint = (pointA[Y] + delta * pointB[Y]) / (1 + delta);
    pointC = [xPoint, yPoint];
  }

  return pointC;
};

var cloudALine = function cloudALine(line, radius, inward) {
  var point = getIntersection(line, radius * 2);
  var remainingLine = line;
  var arc = void 0;
  var cloud = ['M' + line[0][X] + ',' + line[0][Y]];
  var sweep = true === inward ? 0 : 1;
  var lArc = true === inward ? 0 : 1;

  while (point) {
    arc = ' A' + radius + ',' + radius + ' 0 ' + lArc + ',' + sweep + ' ' + point[X] + ',' + point[Y];
    cloud.push(arc);
    remainingLine = [point, remainingLine[1]];
    point = getIntersection(remainingLine, radius * 2);
  }

  return cloud.join('');
};

var fixRadiusToFitLine = function fixRadiusToFitLine(line, radius) {
  var length = lineLength(line);
  var segments = Math.round(length / (2 * radius) + 0.5);

  return 0 < length ? length / segments / 2 : radius;
};

var svgCloud = function svgCloud(polyline, radius, closed, inward) {
  var cloud = '';
  var ind = 1;
  var line = void 0;
  var _radius = 0 < radius ? radius : 1;
  var cnt = polyline.length;

  for (; ind < cnt; ++ind) {
    if (0 >= ind) {
      cloud += ' ';
    }
    line = [polyline[ind - 1], polyline[ind]];
    cloud += cloudALine(line, fixRadiusToFitLine(line, _radius), inward);
  }

  // close to get polygon
  if (true === closed && 1 < cnt) {
    line = [polyline[ind - 1], polyline[0]];
    cloud += ' ' + cloudALine(line, fixRadiusToFitLine(line, _radius), inward);
  }

  // SVG complains about empty path strings
  return cloud || 'M0,0';
};

module.exports = svgCloud;

},{}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJkZW1vL2luZGV4LmpzIiwic3JjL2RlY29yYXRvci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUE7Ozs7OztBQUVBLElBQU0sT0FBTyxTQUFTLGFBQVQsQ0FBdUIsV0FBdkIsQ0FBYjtBQUNBLElBQU0sU0FBUyxDQUNiO0FBQ0UsWUFBVSxTQURaO0FBRUUsVUFBUSxDQUFDLENBQUMsRUFBRCxFQUFLLEdBQUwsQ0FBRCxFQUFZLENBQUMsR0FBRCxFQUFNLEdBQU4sQ0FBWixFQUF3QixDQUFDLEdBQUQsRUFBTSxHQUFOLENBQXhCO0FBRlYsQ0FEYSxFQUtiO0FBQ0UsWUFBVSxTQURaO0FBRUUsVUFBUSxDQUFDLENBQUMsRUFBRCxFQUFLLEdBQUwsQ0FBRCxFQUFZLENBQUMsR0FBRCxFQUFNLEdBQU4sQ0FBWixFQUF5QixDQUFDLEdBQUQsRUFBTSxHQUFOLENBQXpCLEVBQXFDLENBQUMsR0FBRCxFQUFNLEdBQU4sQ0FBckMsRUFBaUQsQ0FBQyxHQUFELEVBQU0sR0FBTixDQUFqRCxFQUNDLENBQUMsRUFBRCxFQUFLLEdBQUwsQ0FERDtBQUZWLENBTGEsRUFVYjtBQUNFLFlBQVUsU0FEWjtBQUVFLFVBQVEsQ0FBQyxDQUFDLEdBQUQsRUFBTSxHQUFOLENBQUQsRUFBYSxDQUFDLEdBQUQsRUFBTSxHQUFOLENBQWIsRUFBeUIsQ0FBQyxHQUFELEVBQU0sR0FBTixDQUF6QjtBQUZWLENBVmEsRUFjYjtBQUNFLFlBQVUsU0FEWjtBQUVFLFVBQVEsQ0FBQyxDQUFDLEdBQUQsRUFBTSxHQUFOLENBQUQsRUFBYSxDQUFDLEdBQUQsRUFBTSxHQUFOLENBQWIsRUFBeUIsQ0FBQyxHQUFELEVBQU0sR0FBTixDQUF6QixFQUFxQyxDQUFDLEdBQUQsRUFBTSxHQUFOLENBQXJDLEVBQWlELENBQUMsR0FBRCxFQUFNLEdBQU4sQ0FBakQsRUFD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QUFyQjs7QUFFQSxTQUFPLE1BQU0sR0FBYixFQUFrQixFQUFFLEdBQXBCLEVBQXlCO0FBQ3ZCLFFBQUksS0FBSyxHQUFULEVBQWM7QUFDWixlQUFTLEdBQVQ7QUFDRDtBQUNELFdBQU8sQ0FBQyxTQUFTLE1BQU0sQ0FBZixDQUFELEVBQW9CLFNBQVMsR0FBVCxDQUFwQixDQUFQO0FBQ0EsYUFBUyxXQUFXLElBQVgsRUFBaUIsbUJBQW1CLElBQW5CLEVBQXlCLE9BQXpCLENBQWpCLEVBQW9ELE1BQXBELENBQVQ7QUFDRDs7QUFFRDtBQUNBLE1BQUksU0FBUyxNQUFULElBQW1CLElBQUksR0FBM0IsRUFBZ0M7QUFDOUIsV0FBTyxDQUFDLFNBQVMsTUFBTSxDQUFmLENBQUQsRUFBb0IsU0FBUyxDQUFULENBQXBCLENBQVA7QUFDQSxhQUFTLE1BQU0sV0FBVyxJQUFYLEVBQWlCLG1CQUFtQixJQUFuQixFQUF5QixPQUF6QixDQUFqQixFQUFvRCxNQUFwRCxDQUFmO0FBQ0Q7O0FBRUQ7QUFDQSxTQUFPLFNBQVMsTUFBaEI7QUFDRCxDQXZCRDs7QUEwQkEsT0FBTyxPQUFQLEdBQWlCLFFBQWpCIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCBzdmdDbG91ZCBmcm9tICcuLi9zcmMvZGVjb3JhdG9yJztcblxuY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cm9scycpO1xuY29uc3QgY2xvdWRzID0gW1xuICB7XG4gICAgc2VsZWN0b3I6ICcjY2xvdWQxJyxcbiAgICBjb29yZHM6IFtbMTAsIDEyMF0sIFsxODAsIDEyMF0sIFsyMzAsIDE4MF1dXG4gIH0sXG4gIHtcbiAgICBzZWxlY3RvcjogJyNjbG91ZDInLFxuICAgIGNvb3JkczogW1syMCwgMzAwXSwgWzE4MCwgMzAwXSwgIFsyMDAsIDMzMF0sIFsxOTAsIDM2MF0sIFsxNDAsIDQyMF0sXG4gICAgICAgICAgICAgWzcwLCAzODBdXVxuICB9LFxuICB7XG4gICAgc2VsZWN0b3I6ICcjY2xvdWQzJyxcbiAgICBjb29yZHM6IFtbNDYwLCAxMjBdLCBbMjkwLCAxMjBdLCBbMjQwLCAxODBdXVxuICB9LFxuICB7XG4gICAgc2VsZWN0b3I6ICcjY2xvdWQ0JyxcbiAgICBjb29yZHM6IFtbNDUwLCAzMDBdLCBbMjkwLCAzMDBdLCBbMjcwLCAzMzBdLCBbMjgwLCAzNjBdLCBbMzMwLCA0MjBdLFxuICAgICAgICAgICAgIFs0MDAsIDM4MF1dXG4gIH0sXG4gIHtcbiAgICBzZWxlY3RvcjogJyNjbG91ZF9sMScsXG4gICAgY29vcmRzOiBbWzEwLCAxMF0sIFsyMzAsIDEwXV1cbiAgfSxcbiAge1xuICAgIHNlbGVjdG9yOiAnI2Nsb3VkX2wyJyxcbiAgICBjb29yZHM6IFtbNDUwLCAxMF0sIFsyNDAsIDEwXV1cbiAgfVxuXTtcblxuXG5jb25zdCByZW5kZXIgPSAoKSA9PiB7XG4gIGxldCBlbGVtO1xuICBsZXQgY2xvdWQ7XG4gIGNvbnN0IHJhZGl1cyA9IHBhcnNlRmxvYXQoZm9ybS5yYWRpdXMudmFsdWUpO1xuICBjb25zdCBjbG9zZWQgPSBmb3JtLmNsb3NlZC5jaGVja2VkO1xuICBjb25zdCBpbndhcmQgPSBmb3JtLmlud2FyZC5jaGVja2VkO1xuXG4gIGZvciAobGV0IGluZCA9IDAsIGNudCA9IGNsb3Vkcy5sZW5ndGg7IGluZCA8IGNudDsgKytpbmQpIHtcbiAgICBlbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjbG91ZHNbaW5kXS5zZWxlY3Rvcik7XG4gICAgY2xvdWQgPSBzdmdDbG91ZChjbG91ZHNbaW5kXS5jb29yZHMsIHJhZGl1cywgY2xvc2VkLCBpbndhcmQpO1xuICAgIGVsZW0uc2V0QXR0cmlidXRlKCdkJywgY2xvdWQpO1xuICB9XG59O1xuXG5mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHJlbmRlcik7XG5yZW5kZXIoKTtcbiIsIlxuLyoqXG4gKiBHZW5lcmF0ZXMgc3ZnIGNsb3VkIGZvciBwb2x5Z29uXG4gKlxuICogQHBhcmFtICB7UG9seWdvbn0gcG9seWdvblxuICpcbiAqIEByZXR1cm4ge1NWRyBQYXRofVxuICovXG5cbmNvbnN0IFggPSAwO1xuY29uc3QgWSA9IDE7XG5jb25zdCBGTE9BVF9QUkVDSVNFID0gMC4wMDAwMDE7XG5cblxuY29uc3QgbGluZUxlbmd0aCA9IChsaW5lKSA9PiB7XG4gIGNvbnN0IHBvaW50QSA9IGxpbmVbMF07XG4gIGNvbnN0IHBvaW50QiA9IGxpbmVbMV07XG5cbiAgcmV0dXJuIE1hdGguc3FydChNYXRoLnBvdygocG9pbnRCW1hdIC0gcG9pbnRBW1hdKSwgMikgK1xuICAgIE1hdGgucG93KChwb2ludEJbWV0gLSBwb2ludEFbWV0pLCAyKSk7XG59O1xuXG5cbmNvbnN0IGdldEludGVyc2VjdGlvbiA9IChsaW5lLCBsZW5ndGgpID0+IHtcbiAgbGV0IHBvaW50QyA9IG51bGw7XG4gIGNvbnN0IHBvaW50QSA9IGxpbmVbMF07XG4gIGNvbnN0IHBvaW50QiA9IGxpbmVbMV07XG4gIGxldCBkZWx0YTtcbiAgbGV0IHhQb2ludDtcbiAgbGV0IHlQb2ludDtcbiAgY29uc3QgZnVsbExlbiA9IGxpbmVMZW5ndGgobGluZSk7XG5cbiAgaWYgKE1hdGguYWJzKGZ1bGxMZW4gLSBsZW5ndGgpIDwgRkxPQVRfUFJFQ0lTRSkge1xuICAgIHBvaW50QyA9IHBvaW50QjtcbiAgfSBlbHNlIGlmIChmdWxsTGVuID4gbGVuZ3RoKSB7XG4gICAgZGVsdGEgPSBsZW5ndGggLyAoZnVsbExlbiAtIGxlbmd0aCk7XG4gICAgeFBvaW50ID0gKHBvaW50QVtYXSArIGRlbHRhICogcG9pbnRCW1hdKSAvICgxICsgZGVsdGEpO1xuICAgIHlQb2ludCA9IChwb2ludEFbWV0gKyBkZWx0YSAqIHBvaW50QltZXSkgLyAoMSArIGRlbHRhKTtcbiAgICBwb2ludEMgPSBbeFBvaW50LCB5UG9pbnRdO1xuICB9XG5cbiAgcmV0dXJuIHBvaW50Qztcbn07XG5cblxuY29uc3QgY2xvdWRBTGluZSA9IChsaW5lLCByYWRpdXMsIGlud2FyZCkgPT4ge1xuICBsZXQgcG9pbnQgPSBnZXRJbnRlcnNlY3Rpb24obGluZSwgcmFkaXVzICogMik7XG4gIGxldCByZW1haW5pbmdMaW5lID0gbGluZTtcbiAgbGV0IGFyYztcbiAgY29uc3QgY2xvdWQgPSBbYE0ke2xpbmVbMF1bWF19LCR7bGluZVswXVtZXX1gXTtcbiAgY29uc3Qgc3dlZXAgPSB0cnVlID09PSBpbndhcmQgPyAwIDogMTtcbiAgY29uc3QgbEFyYyA9IHRydWUgPT09IGlud2FyZCA/IDAgOiAxO1xuXG4gIHdoaWxlIChwb2ludCkge1xuICAgIGFyYyA9IGAgQSR7cmFkaXVzfSwke3JhZGl1c30gMCAke2xBcmN9LCR7c3dlZXB9ICR7cG9pbnRbWF19LCR7cG9pbnRbWV19YDtcbiAgICBjbG91ZC5wdXNoKGFyYyk7XG4gICAgcmVtYWluaW5nTGluZSA9IFtwb2ludCwgcmVtYWluaW5nTGluZVsxXV07XG4gICAgcG9pbnQgPSBnZXRJbnRlcnNlY3Rpb24ocmVtYWluaW5nTGluZSwgcmFkaXVzICogMik7XG4gIH1cblxuICByZXR1cm4gY2xvdWQuam9pbignJyk7XG59O1xuXG5cbmNvbnN0IGZpeFJhZGl1c1RvRml0TGluZSA9IChsaW5lLCByYWRpdXMpID0+IHtcbiAgY29uc3QgbGVuZ3RoID0gbGluZUxlbmd0aChsaW5lKTtcbiAgY29uc3Qgc2VnbWVudHMgPSBNYXRoLnJvdW5kKGxlbmd0aCAvICgyICogcmFkaXVzKSArIDAuNSk7XG5cbiAgcmV0dXJuIDAgPCBsZW5ndGggPyBsZW5ndGggLyBzZWdtZW50cyAvIDIgOiByYWRpdXM7XG59O1xuXG5cbmNvbnN0IHN2Z0Nsb3VkID0gKHBvbHlsaW5lLCByYWRpdXMsIGNsb3NlZCwgaW53YXJkKSA9PiB7XG4gIGxldCBjbG91ZCA9ICcnO1xuICBsZXQgaW5kID0gMTtcbiAgbGV0IGxpbmU7XG4gIGNvbnN0IF9yYWRpdXMgPSAwIDwgcmFkaXVzID8gcmFkaXVzIDogMTtcbiAgY29uc3QgY250ID0gcG9seWxpbmUubGVuZ3RoO1xuXG4gIGZvciAoOyBpbmQgPCBjbnQ7ICsraW5kKSB7XG4gICAgaWYgKDAgPj0gaW5kKSB7XG4gICAgICBjbG91ZCArPSAnICc7XG4gICAgfVxuICAgIGxpbmUgPSBbcG9seWxpbmVbaW5kIC0gMV0sIHBvbHlsaW5lW2luZF1dO1xuICAgIGNsb3VkICs9IGNsb3VkQUxpbmUobGluZSwgZml4UmFkaXVzVG9GaXRMaW5lKGxpbmUsIF9yYWRpdXMpLCBpbndhcmQpO1xuICB9XG5cbiAgLy8gY2xvc2UgdG8gZ2V0IHBvbHlnb25cbiAgaWYgKHRydWUgPT09IGNsb3NlZCAmJiAxIDwgY250KSB7XG4gICAgbGluZSA9IFtwb2x5bGluZVtpbmQgLSAxXSwgcG9seWxpbmVbMF1dO1xuICAgIGNsb3VkICs9ICcgJyArIGNsb3VkQUxpbmUobGluZSwgZml4UmFkaXVzVG9GaXRMaW5lKGxpbmUsIF9yYWRpdXMpLCBpbndhcmQpO1xuICB9XG5cbiAgLy8gU1ZHIGNvbXBsYWlucyBhYm91dCBlbXB0eSBwYXRoIHN0cmluZ3NcbiAgcmV0dXJuIGNsb3VkIHx8ICdNMCwwJztcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBzdmdDbG91ZDtcbiJdfQ==
